ans1(productLabel, offer, price, vendor, vendorTitle, review, revTitle, reviewer, revName, rating1, rating2)
CONSTRUCT [productLabel, offer, price, vendor, vendorTitle, review, revTitle, reviewer, revName, rating1, rating2] [offer/RDF(http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/dataFromVendor/Offer{}(INTEGERToSTRING(nr1m5)),IF_ELSE_NULL(IS_NOT_NULL(nr1m5),IRI)), productLabel/RDF(label10m40,xsd:string), rating1/RDF(INTEGERToSTRING(rating1m16),IF_ELSE_NULL(IS_NOT_NULL(rating1m16),xsd:integer)), rating2/RDF(INTEGERToSTRING(rating1m17),IF_ELSE_NULL(IS_NOT_NULL(rating1m17),xsd:integer)), review/RDF(http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/dataFromRatingSite/Review{}(INTEGERToSTRING(nr0m4)),IF_ELSE_NULL(IS_NOT_NULL(nr0m4),IRI)), price/RDF(DOUBLEToSTRING(price1m34),IF_ELSE_NULL(IS_NOT_NULL(price1m34),xsd:double)), vendor/RDF(http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/dataFromVendor/Vendor{}(INTEGERToSTRING(vendor1m8)),IF_ELSE_NULL(IS_NOT_NULL(vendor1m8),IRI)), reviewer/RDF(http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/dataFromRatingSite/Reviewer{}(INTEGERToSTRING(person2m7)),IF_ELSE_NULL(IS_NOT_NULL(person2m7),IRI)), revTitle/RDF(title2m11,IF_ELSE_NULL(IS_NOT_NULL(title2m11),xsd:string)), revName/RDF(name1m12,IF_ELSE_NULL(IS_NOT_NULL(name1m12),xsd:string)), vendorTitle/RDF(label10m4,IF_ELSE_NULL(IS_NOT_NULL(label10m4),xsd:string))]
   DISTINCT
      LJ
         LJ AND4(DATE_GT(validto1m39,"2008-06-13"^^DATE),IS_NOT_NULL(price1m34),IS_NOT_NULL(label10m4),IS_NOT_NULL(validto1m39))
            UNION [label10m40]
               FILTER IS_NOT_NULL(label10m40)
                  EXTENSIONAL "s1"."product1"(0:"94"^^INTEGER,1:label10m40)
               FILTER IS_NOT_NULL(label10m40)
                  EXTENSIONAL "s5"."product2"(0:"94"^^INTEGER,1:label10m40)
            JOIN
               EXTENSIONAL "s4"."offer"(0:nr1m5,1:"94"^^INTEGER,3:vendor1m8,4:price1m34,6:validto1m39)
               EXTENSIONAL "s4"."vendor"(0:vendor1m8,1:label10m4,4:"DE"^^STRING)
         LJ
            LJ
               DISTINCT
                  JOIN IS_NOT_NULL(name1m12)
                     UNION [nr0m4]
                        EXTENSIONAL "s1"."reviewc"(0:nr0m4,1:"94"^^INTEGER)
                        EXTENSIONAL "s2"."review"(0:nr0m4,1:"94"^^INTEGER)
                     UNION [nr0m4, person2m7, name1m12]
                        JOIN
                           EXTENSIONAL "s1"."reviewc"(0:nr0m4,3:person2m7)
                           EXTENSIONAL "s2"."person"(0:person2m7,1:name1m12)
                        JOIN
                           EXTENSIONAL "s2"."review"(0:nr0m4,3:person2m7)
                           EXTENSIONAL "s2"."person"(0:person2m7,1:name1m12)
                     UNION [nr0m4, title2m11]
                        FILTER IS_NOT_NULL(title2m11)
                           EXTENSIONAL "s1"."reviewc"(0:nr0m4,5:title2m11)
                        FILTER IS_NOT_NULL(title2m11)
                           EXTENSIONAL "s2"."review"(0:nr0m4,5:title2m11)
               UNION [nr0m4, rating1m16]
                  FILTER IS_NOT_NULL(rating1m16)
                     EXTENSIONAL "s1"."reviewc"(0:nr0m4,8:rating1m16)
                  FILTER IS_NOT_NULL(rating1m16)
                     EXTENSIONAL "s2"."review"(0:nr0m4,8:rating1m16)
            UNION [nr0m4, rating1m17]
               FILTER IS_NOT_NULL(rating1m17)
                  EXTENSIONAL "s1"."reviewc"(0:nr0m4,9:rating1m17)
               FILTER IS_NOT_NULL(rating1m17)
                  EXTENSIONAL "s2"."review"(0:nr0m4,9:rating1m17)
